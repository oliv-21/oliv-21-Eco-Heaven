<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
    <title>EcoHaven Dashboard</title>
    <link rel="stylesheet" href="../../static/thumbnail/Rider-page/my-deliveries.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

</head>
<body>
    <div class="header">
        <div class="logo-container">
            <a href="/rider_dashboard"><img class="logo" src="../../static/thumbnail/logo.png.png" alt=""></a>
        </div>

        <div class="profile-container">
            <img class="profile-img" src="{{ url_for('static', filename='uploads/' + profile_pic) }}"
                 title="View Profile" style="cursor: pointer;"
                 onclick="window.location.href='/rider_dashboard/rider_profile';">
            <span id="user-name">{{Fname}}</span>
         </div>
    </div>

    <div class="container">
        <nav class="sidebar">
            <ul>
                <a href="/rider_dashboard"><li>Available Deliveries</li></a>
                <a href="#"><li class="active">My Deliveries</li></a>
                <a href="/rider_dashboard/deliveredCompleted"><li>Completed Deliveries</li></a>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <div class="sales-summary">
                <p>Ongoing Deliveries: <span class="count">{{order_count}}</span></p>
                <div class="search-container">
                    <form action="{{ url_for('search_parcelOTW') }}" class="search-container">
                        <input class="search-bar" type="text" name="search" placeholder="Search">
                        <button class="search-btn" type="submit">
                            <img src="../../static/thumbnail/search.svg" alt="">
                        </button>
                    </form>
                </div>
            </div>
            
            <table class="sales-table">
                <thead>
                    <tr>
                        <th>Order ID</th>
                        <th>Name</th>
                        <th>Address</th>
                        <th style="text-align: center;">Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for order in order_data %}
                        <tr data-price="{{ order.total_price }}" data-contact="{{ order.mobile_number }}" >
                            <td class="orderID">          
                                <span id="productID">{{order.order_id}}</span>
                            </td>          
                            <td><span id="name">{{order.fullname}}</td>     
                            <td><span id="address"> {{order.Fulladdress}}</td>
                            
                            <td>
                                <div  class="actions">
                                    <div><Button  class="details-btn">Details</Button></div>
                                    <div>
                                        <form action="{{ url_for('rider_delivered') }}" method="POST">
                                            <input type="hidden" name="order_id" value="{{ order.order_id }}">

                                            <button type="submit" class="delivered-btn"> Delivered </button>
                                        </form>
                                        
                                    </div>
                                </div>        
                            </td>
                        </tr>
                    {% endfor %}       
                    
                          
                    <!-- Add more rows as needed -->
                </tbody>
            </table>

            <div id="details-card" class="info-container" style="display: none;">
                <span id="close-btn" class="close-btn">&times;</span>
            
                <div class="id-container">
                    <div class="receiver-info"><h3>Receiver Information</h3></div>  
                    <h4 id="details-order-id"></h4><br>
                    <p id="details-name"></p>
                    <p id="details-address"></p><br>
                    <p>Tel: <span id="details-contact"></span></p>
                </div>
            
                <div class="amount-container" style="color: #133157; font-weight: 600;">
                    <div><p>Amount</p></div>
                    <div><p id="details-price"></p></div>
                </div>
            
                <div>
                    <div> 
                        <button class="return-btn">Return to Pool</button>
                        <button class="return-btn">Cancel ORDER</button>
                    </div>
                    
                </div>
            </div>
            

        </main>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const closeBtnEl = document.getElementById("close-btn");
            const detailsBtnEls = document.querySelectorAll(".details-btn");
            const detailsCard = document.getElementById("details-card");
    
            detailsBtnEls.forEach(button => {
                button.addEventListener("click", function () {
                    const row = this.closest("tr"); // Get the row of the clicked button
                    document.getElementById("details-order-id").textContent = row.querySelector("#productID").textContent;
                    document.getElementById("details-name").textContent = row.querySelector("#name").textContent;
                    document.getElementById("details-address").textContent = row.querySelector("#address").textContent;
                    document.getElementById("details-contact").textContent = row.dataset.contact;
                    document.getElementById("details-price").textContent = row.dataset.price + " Php";
    
                    detailsCard.style.display = "flex"; // Show the details card
                });
            });
    
            closeBtnEl.addEventListener("click", function () {
                detailsCard.style.display = "none"; // Hide the details card
            });
        });
    </script>
    

    
</body>
</html>
